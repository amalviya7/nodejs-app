{"version":"1.137.0","results":[{"check_id":"problem-based-packs.insecure-transport.js-node.bypass-tls-verification.bypass-tls-verification","path":"healthcheck.js","start":{"line":3,"col":17,"offset":49},"end":{"line":9,"col":2,"offset":145},"extra":{"message":"Checks for setting the environment variable NODE_TLS_REJECT_UNAUTHORIZED to 0, which disables TLS verification. This should only be used for debugging purposes. Setting the option rejectUnauthorized to false bypasses verification against the list of trusted CAs, which also leads to insecure transport. These options lead to vulnerability to MTM attacks, and should not be used.","metadata":{"likelihood":"MEDIUM","impact":"MEDIUM","confidence":"MEDIUM","category":"security","cwe":"CWE-319: Cleartext Transmission of Sensitive Information","owasp":"A03:2017 - Sensitive Data Exposure","references":["https://nodejs.org/api/https.html#https_https_request_options_callback","https://stackoverflow.com/questions/20433287/node-js-request-cert-has-expired#answer-29397100"],"subcategory":["vuln"],"technology":["node.js"],"vulnerability":"Insecure Transport","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Mishandled Sensitive Information"],"source":"https://semgrep.dev/r/problem-based-packs.insecure-transport.js-node.bypass-tls-verification.bypass-tls-verification","shortlink":"https://sg.run/9oxr"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"terraform.lang.security.ecr-image-scan-on-push.ecr-image-scan-on-push","path":"terraform/main.tf","start":{"line":58,"col":1,"offset":915},"end":{"line":58,"col":9,"offset":923},"extra":{"message":"The ECR Repository isn't configured to scan images on push","metadata":{"cwe":["CWE-1104: Use of Unmaintained Third Party Components"],"category":"security","technology":["terraform","aws"],"owasp":["A06:2021 - Vulnerable and Outdated Components"],"references":["https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components"],"subcategory":["audit"],"likelihood":"LOW","impact":"LOW","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Other"],"source":"https://semgrep.dev/r/terraform.lang.security.ecr-image-scan-on-push.ecr-image-scan-on-push","shortlink":"https://sg.run/R8eE"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"terraform.aws.security.aws-ecr-mutable-image-tags.aws-ecr-mutable-image-tags","path":"terraform/main.tf","start":{"line":58,"col":1,"offset":915},"end":{"line":60,"col":2,"offset":988},"extra":{"message":"The ECR repository allows tag mutability. Image tags could be overwritten with compromised images. ECR images should be set to IMMUTABLE to prevent code injection through image mutation. This can be done by setting `image_tag_mutability` to IMMUTABLE.","metadata":{"category":"security","technology":["terraform","aws"],"owasp":["A08:2021 - Software and Data Integrity Failures"],"cwe":["CWE-345: Insufficient Verification of Data Authenticity"],"references":["https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ecr_repository#image_tag_mutability","https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/"],"subcategory":["audit"],"likelihood":"LOW","impact":"HIGH","confidence":"MEDIUM","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Improper Authentication"],"source":"https://semgrep.dev/r/terraform.aws.security.aws-ecr-mutable-image-tags.aws-ecr-mutable-image-tags","shortlink":"https://sg.run/ZEeL"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}},{"check_id":"terraform.aws.security.aws-secretsmanager-secret-unencrypted.aws-secretsmanager-secret-unencrypted","path":"terraform/main.tf","start":{"line":63,"col":1,"offset":1008},"end":{"line":65,"col":2,"offset":1085},"extra":{"message":"By default, AWS SecretManager secrets are encrypted using AWS-managed keys. However, for added security, it's recommended to configure your own AWS KMS encryption key to protect your secrets in the Secret Manager. You can either create a new aws_kms_key resource or use the ARN of an existing key in your AWS account to do so.","metadata":{"owasp":["A03:2017 - Sensitive Data Exposure","A02:2021 - Cryptographic Failures"],"cwe":["CWE-326: Inadequate Encryption Strength"],"technology":["aws","terraform"],"category":"security","references":["https://owasp.org/Top10/A02_2021-Cryptographic_Failures"],"subcategory":["audit"],"likelihood":"LOW","impact":"LOW","confidence":"LOW","license":"Semgrep Rules License v1.0. For more details, visit semgrep.dev/legal/rules-license","vulnerability_class":["Cryptographic Issues"],"source":"https://semgrep.dev/r/terraform.aws.security.aws-secretsmanager-secret-unencrypted.aws-secretsmanager-secret-unencrypted","shortlink":"https://sg.run/nrRX"},"severity":"WARNING","fingerprint":"requires login","lines":"requires login","validation_state":"NO_VALIDATOR","engine_kind":"OSS"}}],"errors":[{"code":3,"level":"warn","type":"Syntax error","message":"Syntax error at line semgrep-results.json:1:\n missing element","path":"semgrep-results.json"},{"code":3,"level":"warn","type":["PartialParsing",[{"path":".github/workflows/ci.yml","start":{"line":103,"col":36,"offset":2705},"end":{"line":103,"col":57,"offset":2726}}]],"message":"Syntax error at line .github/workflows/ci.yml:103:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `{ secrets.MONGODB_URI` was unexpected","path":".github/workflows/ci.yml","spans":[{"file":".github/workflows/ci.yml","start":{"line":103,"col":36,"offset":2705},"end":{"line":103,"col":57,"offset":2726}}]},{"code":3,"level":"warn","type":["PartialParsing",[{"path":".github/workflows/ci.yml","start":{"line":108,"col":51,"offset":2837},"end":{"line":108,"col":72,"offset":2858}}]],"message":"Syntax error at line .github/workflows/ci.yml:108:\n When parsing a snippet as Bash for metavariable-pattern in rule 'yaml.github-actions.security.curl-eval.curl-eval', `{ secrets.MONGODB_URI` was unexpected","path":".github/workflows/ci.yml","spans":[{"file":".github/workflows/ci.yml","start":{"line":108,"col":51,"offset":2837},"end":{"line":108,"col":72,"offset":2858}}]}],"paths":{"scanned":[".env.example",".github/workflows/ci.yml",".gitignore","Dockerfile","LICENSE","README.md","app.js","deploy.sh","docker-compose.yml","healthcheck.js","package-lock.json","package.json","report.md","report.pdf","seccomp.json","semgrep-results.json","terraform/main.tf","trivy-image-results.json","trivy-results.sarif"]},"time":{"rules":[],"rules_parse_time":1.201179027557373,"profiling_times":{"config_time":1.5854125022888184,"core_time":1.9825160503387451,"ignores_time":0.0014407634735107422,"total_time":3.5699074268341064},"parsing_time":{"total_time":0.0,"per_file_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"scanning_time":{"total_time":0.39376020431518555,"per_file_time":{"mean":0.007875204086303713,"std_dev":0.0004180208225284332},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_files":[]},"matching_time":{"total_time":0.0,"per_file_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_files":[]},"tainting_time":{"total_time":0.0,"per_def_and_rule_time":{"mean":0.0,"std_dev":0.0},"very_slow_stats":{"time_ratio":0.0,"count_ratio":0.0},"very_slow_rules_on_defs":[]},"fixpoint_timeouts":[],"prefiltering":{"project_level_time":0.0,"file_level_time":0.0,"rules_with_project_prefilters_ratio":0.0,"rules_with_file_prefilters_ratio":0.9459843638948117,"rules_selected_ratio":0.14498933901918976,"rules_matched_ratio":0.14498933901918976},"targets":[],"total_bytes":0,"max_memory_bytes":1112845376},"engine_requested":"OSS","skipped_rules":[]}
